# ServiceNow GxP対応アプローチ

---

## 概要

ServiceNowをGxP環境で利用するためには、「フローを作ること」と「そのフローをバリデーションすること」の2段階が必要です。本ドキュメントでは、V字モデルに沿ってServiceNow GxP対応を進めるための実践的なアプローチを整理します。

---

## 全体構造

GxP対応は以下の3フェーズで進めます。

```
Phase 1: スコープ定義・リスク評価
　　↓
Phase 2: フロー設計・構築（V字モデル 左側）
　　↓
Phase 3: バリデーション実施（V字モデル 右側）
　　↓
　運用・維持管理
```

---

## Phase 1：スコープ定義・リスク評価

### 目的
GxP対象プロセスの範囲を明確にし、バリデーションレベルを決定する。

### 実施内容

#### 1-1. GxP対象プロセスの特定

ServiceNow上で扱うプロセスをGxP影響の有無で分類します。

| プロセス | GxP影響 | GAMPカテゴリ |
|---------|--------|------------|
| 逸脱管理（Deviation） | あり | Cat. 4/5 |
| CAPA管理 | あり | Cat. 4/5 |
| 変更管理（Change Control） | あり | Cat. 4/5 |
| 監査指摘管理（Audit Finding） | あり | Cat. 4/5 |
| 苦情管理（Complaint） | あり | Cat. 4/5 |
| 通常ITインシデント管理 | なし | 対象外 |
| 社内ヘルプデスク | なし | 対象外 |

#### 1-2. リスク評価

GxP対象プロセスごとに以下を評価します。

- 製品品質・患者安全への影響度
- データ完全性リスク（ALCOA+観点）
- 規制要件との紐づけ（21 CFR Part 11、Annex 11など）

#### 1-3. バリデーション戦略の合意

QA・CSVチームと以下を合意します。

- バリデーション対象範囲（テーブル・ワークフロー・インテグレーション）
- テスト網羅度（リスクに応じたIQ/OQ/PQの要否）
- 文書体系（SOP、テンプレート）

---

## Phase 2：フロー設計・構築（V字モデル 左側）

V字モデルの左側にあたる設計フェーズです。ここでの文書が右側のバリデーションの基準となります。

### 2-1. 対象フローの定義

ServiceNow上に構築すべきGxP品質フローは以下の5つです。Veevaでは標準搭載されているこれらのフローを、ServiceNow上でゼロから設計・構築します。

| # | フロー | 対応するVeeva標準機能 | 主な規制要件 |
|---|-------|-------------------|------------|
| 1 | 逸脱管理（Deviation） | Deviation オブジェクト | 21 CFR Part 211、GMP |
| 2 | CAPA管理 | CAPA オブジェクト | 21 CFR Part 820、ICH Q10 |
| 3 | 変更管理（Change Control） | Change Control オブジェクト | GMP Annex 15、ICH Q10 |
| 4 | 監査指摘管理（Audit Finding） | Audit Management モジュール | 21 CFR Part 211 |
| 5 | 苦情管理（Complaint） | Complaints モジュール | 21 CFR Part 211.198 |

---

### 2-2. URS（ユーザー要求仕様）

**「何をしたいか」をGxP要件として、フローごとに定義する文書です。**

#### フロー①：逸脱管理

- SOPや規格からの逸脱事象を起票・記録できること
- QAによる重大度評価（Minor／Major／Critical）を記録できること
- 調査・原因究明のタスクを関係部署へ自動割り当てできること
- 暫定処置・恒久対策の記録ができること
- QAによる電子署名付き承認でクローズできること
- 重大度に応じてCAPAへ自動昇格できること

#### フロー②：CAPA管理

- 逸脱・監査指摘・苦情などのトリガーイベントと紐づけて起票できること
- 根本原因分析（5Why・魚骨図など）の記録ができること
- 是正措置・予防措置のタスクを担当者・期日付きで管理できること
- 効果確認（Effectiveness Check）のタスクを期日指定で自動生成できること
- QAによる最終承認・クローズが電子署名付きで記録されること

#### フロー③：変更管理

- 変更要求を起票し、変更内容・理由・対象範囲を記録できること
- 品質・バリデーション・規制申請などへの影響評価を記録できること
- クロスファンクショナルな承認ルート（QA／QC／生産など）を設定できること
- 実施計画（手順改訂・再バリデーション・トレーニングなど）をタスクとして管理できること
- 実施後レビューの記録・QAによる最終クローズが電子署名付きで行えること

#### フロー④：監査指摘管理

- 内部・外部監査の指摘事項を起票・記録できること
- 重大度評価と対応期日の設定ができること
- 指摘事項からCAPAへの昇格が行えること
- 対応状況の追跡・期日超過アラートが機能すること

#### フロー⑤：苦情管理

- 顧客・市場からの苦情を受付・記録できること
- リスク分類（Low／High）に応じた後続フロー（即クローズ／逸脱・CAPA連携）に分岐できること
- 製品ロットとの紐づけ記録ができること
- 顧客への回答記録・クローズが電子署名付きで行えること

---

### 2-3. FS（機能仕様）

**「どんな機能が必要か」をServiceNowの機能に落とし込む文書です。**

URSの各要件をServiceNow機能にマッピングします。

| URS要件 | 対応するServiceNow機能 |
|--------|----------------------|
| 各フローの起票・記録 | カスタムテーブル（Deviation／CAPA／Change等）の作成 |
| 重大度評価・分類 | 選択フィールド・条件分岐ロジック（Business Rule） |
| タスク自動割り当て | Flow Designer／ワークフローによる自動アサイン |
| フロー間の自動昇格（例：逸脱→CAPA） | Flow Designerのトリガー・サブフロー |
| 電子署名 | 承認ステップ・再認証スクリプト（21 CFR Part 11準拠） |
| 監査証跡 | sys_auditテーブルの有効化・対象テーブル定義 |
| アクセス制御 | RBACロール設計・ACLルール定義 |
| 期日管理・アラート | SLAエンジン・通知ルール |
| トリガーイベントの紐づけ | テーブルリレーション・参照フィールド |

### 2-4. DS（設計仕様）

**「どう設定・構築するか」を具体的に記述する文書です。**

- テーブル設計（フィールド定義・必須項目・デフォルト値・参照整合性）
- ワークフロー設計（各フローの承認ルート・条件分岐・タスク割り当て・自動昇格条件）
- RBAC設計（ロール定義・権限マトリクス）
- 監査証跡設計（対象テーブル・記録項目・保持期間）
- インテグレーション設計（Veeva連携のAPIマッピングなど）

### 2-5. 構築

DSに基づきServiceNow上にフローを実装します。GxP対象とNon-GxP対象を明確に分離し、スコープアプリ・インスタンス分離などの方針に従います。

---

## Phase 3：バリデーション実施（V字モデル 右側）

V字モデルの右側にあたる検証フェーズです。左側の各設計文書に対応する形でテストを実施します。

```
URS ────────────────────────── PQ（受け入れテスト）
　FS ──────────────────── OQ（運用適格性確認）
　　DS ──────────── IQ（据付適格性確認）
```

### 3-1. IQ（据付適格性確認）

**「正しく設定・インストールされているか」を確認します。**

DSに基づき、以下を確認・記録します。

- テーブル・フィールドが仕様通りに設定されているか
- RBACロール・ACLが正しく定義されているか
- 監査証跡の有効化設定が正しいか
- インテグレーション接続設定が正しいか

### 3-2. OQ（運用適格性確認）

**「機能がFSの通りに動くか」を確認します。**

各機能について、正常系・異常系のテストを実施・記録します。

| テスト項目 | 確認内容 | 期待結果 |
|----------|--------|--------|
| 監査証跡 | レコード作成・更新・削除時にsys_auditへ記録されるか | 操作内容・日時・ユーザーが記録される |
| 電子署名 | 承認ステップで再認証が求められるか | パスワード再入力・署名理由の記録が必須 |
| RBAC | 権限のないユーザーがGxPデータを編集できないか | アクセス拒否・エラーメッセージ表示 |
| データ完全性 | 必須項目が空のままレコードを保存できないか | 保存不可・エラーメッセージ表示 |

### 3-3. PQ（製造適格性確認）

**「実際の業務シナリオで意図通りに動くか」を確認します。**

URSに定義した要件をフローごとに業務シナリオとして実行し、エンドツーエンドで確認します。

**シナリオ①：逸脱管理**
```
① 現場担当者が逸脱事象を起票
② QAが重大度をMajorと評価・記録
③ 調査タスクが関係部署へ自動割り当てされる
④ 調査結果・暫定処置が記録される
⑤ 重大度判定によりCAPAへ自動昇格される
⑥ QAが電子署名付きでクローズ
⑦ 全操作が監査証跡に記録されていることを確認
```

**シナリオ②：CAPA管理**
```
① 逸脱レコードからCAPAが自動起票される
② 根本原因分析の記録が入力される
③ 是正措置・予防措置タスクが担当者・期日付きで作成される
④ 効果確認タスクが期日指定で自動生成される
⑤ 各タスク完了後、QAが電子署名付きで最終承認・クローズ
⑥ 全操作が監査証跡に記録されていることを確認
```

**シナリオ③：変更管理**
```
① 担当部門が変更要求を起票
② 影響評価（品質・バリデーション・規制申請）が記録される
③ QA／QC／生産の承認ルートで電子署名付き承認が行われる
④ 実施計画タスク（手順改訂・再バリデーション等）が管理される
⑤ 実施後レビューが記録され、QAが最終クローズ
⑥ 全操作が監査証跡に記録されていることを確認
```

**シナリオ④：監査指摘管理**
```
① 監査担当者が指摘事項を起票・重大度設定
② 対応期日が設定され、期日超過時にアラートが発火する
③ 対応完了後、CAPAへ昇格される
④ 全操作が監査証跡に記録されていることを確認
```

**シナリオ⑤：苦情管理**
```
① 顧客苦情が受付・記録される
② リスク分類Highの場合、逸脱・CAPAへ自動連携される
③ リスク分類Lowの場合、即クローズルートへ分岐される
④ 顧客回答が電子署名付きで記録・クローズされる
⑤ 全操作が監査証跡に記録されていることを確認
```

---

## 運用・維持管理

バリデーション完了後も、以下の維持管理が必要です。

### 変更管理

ServiceNowの設定変更・アップグレードは必ず変更管理プロセスを経由します。GxP対象範囲への影響評価を行い、必要に応じて再バリデーション（部分的または全体）を実施します。

### 定期レビュー

- 年次での定期的な監査証跡レビュー
- RBACロール・権限の棚卸し
- バリデーション文書の最新化

### 設定ドリフト管理

本番環境と検証環境の設定差異（ドリフト）は「バリデーション崩壊」につながる最大リスクです。クローン戦略・デプロイパイプラインで統制します。

---

## まとめ：Veevaとの工数比較

| フェーズ | ServiceNow | Veeva |
|--------|-----------|-------|
| URS作成 | 自社でGxPドメイン知識をもとにゼロから作成 | ベンダー提供テンプレートをベースに自社適合確認のみ |
| FS・DS作成 | 自社で機能設計・設定設計を作成 | 標準フローのFit/Gap分析のみ |
| IQ/OQ/PQ | 全テストケースを自社で設計・実施・記録 | カスタマイズ部分のみ追加テスト |
| 維持管理 | アップグレードのたびに影響評価・再バリデーション | ベンダーが事前バリデーション済み、差分のみ対応 |

**ServiceNowのGxP対応で最も重要なのは、「GxPドメイン知識を持つQA・CSVチーム」と「V字モデルを回せる実行体制」の両方を社内または外部パートナーとして確保することです。**

---

*本ドキュメントはServiceNow GxP対応の概念的アプローチを示すものです。実際の運用にあたっては、自社のSOP・規制要件・リスク評価に基づき詳細化することを推奨します。*
